webpackJsonp([28],{640:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i(883),o=i(884),a=i(15),r=a(s.a,o.a,null,null,null);e.default=r.exports},883:function(t,e,i){"use strict";var s=i(180),o=i(179),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t};e.a={name:"service",props:["id"],components:{ContentHeader:s.a,cSwitch:o.a},data:function(){return{name:"Service 상세",originItems:{},serviceName:"",items:{originList:[],modifyHistReason:null,processStateCode:null,processId:null},code:{serviceTypeList:[],originSectionCode:[],bucket:{}},history:{fields:{createId:{label:"등록/수정자",class:"text-left"},histBeginDateTime:{label:"등록/수정일시"},modifyHistReason:{label:"변경이력",class:"text-left"},histMgmtId:{label:"보기"}},items:[],pageInfo:{page:1,size:10,totalCount:1}},isLoad:{originSectionCode:!0,originBucketId:!0},isCreate:!1,isEdit:!1,isModalHistory:!1,inValidForm:!1}},computed:{isProcessComplete:function(){return null===this.items.processId||null!==this.items.processStateCode&&""!==this.items.processStateCode&&"PROCESS_STATE_02"===this.items.processStateCode}},created:function(){var t=this,e=this.$route.query.histories,i=void 0!==e?"/services/"+this.id+"/origins/histories/"+e:"/services/"+this.id+"/origins";e&&document.querySelector("body.app").classList.add("history-mode"),this.$https.get("/services/"+this.id).then(function(e){t.serviceName=e.data.items.serviceName});var s=function(e){return t.isLoad.originSectionCode=!1,t.code.originSectionCode=e.data.items,t.$https.get(i+"/types")},o=function(e){return t.code.serviceTypeList=e.data.items,t.$https.get(i)};(function(){return t.$https.get("/system/commonCode",{q:{groupCode:"ORIGIN_SECTION"}})})().then(s).then(o).then(this.fetchDetail)},methods:{fetchDetail:function(t){null===t.data.items?(this.isCreate=!0,this.isEdit=!0):(this.originList=t.data.items.originList,this.items=a({},t.data.items,{originList:[]})),this.code.serviceTypeList.forEach(this.fetchBucketList)},fetchBucketList:function(t){var e=this,i=t.serviceTypeCode,s=t.serviceTypeName;(function(){return e.$https.get("/services/origins/buckets",{serviceType:i})})().then(function(t){e.code.bucket[s]=t.data.items,e.setOriginList(i,s)})},setOriginList:function(t,e){var i=this.isCreate?{serviceTypeCode:t,serviceTypeName:e,originSectionCode:"ORIGIN_SECTION_01",originSectionCodeName:"",originBucketId:null,originBucketName:"",operatorName:"",operatorTeamName:"",originDomainName:null,originPort:null}:this.originList.find(function(e){return e.serviceTypeCode===t}),s=this.code.bucket[e],o=this.code.originSectionCode.find(function(t){return t.code===i.originSectionCode}),r=o?o.codeName:"",n=i.originBucketId?s.find(function(t){return t.originBucketId===i.originBucketId}):null;this.items.originList.push(a({},i,{originSectionCodeName:r,originBucketId:n}))},onEdit:function(){this.isEdit=!0},onView:function(){this.isEdit=!1,this.items=JSON.parse(JSON.stringify(this.originItems))},onSubmit:function(){var t=this,e=this.items.originList.map(function(e){var i=e.serviceTypeCode,s=e.originSectionCode,o=e.originBucketId,r=e.originDomainName,n=e.originPort,l={serviceTypeCode:i,originSectionCode:s,modifyHistReason:t.items.modifyHistReason};return"ORIGIN_SECTION_01"===s?a({},l,{originBucketId:o?o.originBucketId:null}):a({},l,{originDomainName:r,originPort:n})}),i=this.$valid.all(e),s=this.isCreate?function(){return t.$https.post("/services/"+t.id+"/origins",e)}:function(){return t.$https.put("/services/"+t.id+"/origins",e)};this.inValidForm=!i,i&&s().then(function(){t.$router.go(t.$router.currentRoute)}).catch(function(t){console.log(t)})},onBucket:function(t,e){var i=t.operatorName,s=t.operatorTeamName;this.items.originList[e].operatorName=i,this.items.originList[e].operatorTeamName=s},getHistoryLink:function(t){return"#/service/service/"+this.id+"/origin?histories="+t},showHistory:function(){var t=this;this.isModalHistory=!this.isModalHistory,this.$https.get("/services/"+this.id+"/origins/histories").then(function(e){t.history.items=e.data.items})}}}},884:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"animated fadeIn"},[i("content-header",{attrs:{title:t.serviceName,name:t.name}}),t._v(" "),i("div",{staticClass:"collapse-title"},[i("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.formDefault",modifiers:{formDefault:!0}}],staticClass:"btn-collapse"},[i("i",{staticClass:"fa"}),t._v("\n      Origin\n    ")])],1),t._v(" "),i("b-collapse",{attrs:{id:"formDefault",visible:""}},[i("b-form",{staticClass:"formView",attrs:{validated:t.inValidForm,novalidate:""}},[t._l(t.items.originList,function(e,s){return i("div",{key:e.serviceTypeCode,staticClass:"repeats"},[i("h3",{staticClass:"content-title"},[i("i",{staticClass:"fa fa-circle"}),t._v(" "+t._s(e.serviceTypeName))]),t._v(" "),i("b-form-fieldset",{attrs:{horizontal:!0}},[i("template",{slot:"label"},[t._v("\n            Origin 사용 설정"),t.isEdit?i("i",{staticClass:"require"},[t._v("*")]):t._e()]),t._v(" "),t.isEdit?i("b-form-radio-group",{attrs:{options:t.code.originSectionCode,name:e.serviceTypeCode,"value-field":"code","text-field":"codeName"},model:{value:e.originSectionCode,callback:function(i){t.$set(e,"originSectionCode",i)},expression:"origin.originSectionCode"}}):i("b-form-input",{attrs:{value:e.originSectionCodeName,type:"text",plaintext:""}})],2),t._v(" "),"ORIGIN_SECTION_01"===e.originSectionCode?i("b-form-fieldset",{attrs:{"invalid-feedback":t.$valid.msg.select,horizontal:!0}},[i("template",{slot:"label"},[t._v("\n            Bucket 선택"),t.isEdit?i("i",{staticClass:"require"},[t._v("*")]):t._e()]),t._v(" "),t.isEdit?i("multiselect",{staticClass:"inline",class:{invalid:null===e.originBucketId},staticStyle:{"min-width":"160px"},attrs:{label:"originBucketName",id:s,showLabels:!1,searchable:!1,options:t.code.bucket[e.serviceTypeName],placeholder:"Select Bucket"},on:{select:t.onBucket},model:{value:e.originBucketId,callback:function(i){t.$set(e,"originBucketId",i)},expression:"origin.originBucketId"}}):i("span",{staticClass:"form-text-alone"},[t._v("\n            "+t._s(e.originBucketName)+"\n          ")]),t._v(" "),i("span",{staticClass:"form-text-alone"},[t._v("\n            ( "+t._s(e.operatorName)+" /\n            "+t._s(e.operatorTeamName)+" )\n          ")])],2):t._e(),t._v(" "),"ORIGIN_SECTION_02"===e.originSectionCode?i("b-form-fieldset",{attrs:{"invalid-feedback":t.$valid.msg.require,horizontal:!0}},[i("template",{slot:"label"},[t._v("\n            Origin Domain"),t.isEdit?i("i",{staticClass:"require"},[t._v("*")]):t._e()]),t._v(" "),i("b-form-input",{attrs:{type:"text",plaintext:!t.isEdit,required:""},model:{value:e.originDomainName,callback:function(i){t.$set(e,"originDomainName",i)},expression:"origin.originDomainName"}})],2):t._e(),t._v(" "),"ORIGIN_SECTION_02"===e.originSectionCode?i("b-form-fieldset",{attrs:{"invalid-feedback":t.$valid.msg.require,horizontal:!0}},[i("template",{slot:"label"},[t._v("\n            Port"),t.isEdit?i("i",{staticClass:"require"},[t._v("*")]):t._e()]),t._v(" "),t.isEdit?i("cleave",{staticClass:"form-control",staticStyle:{width:"120px"},attrs:{options:{numeral:!0,numeralPositiveOnly:!0,numeralDecimalScale:0},required:""},model:{value:e.originPort,callback:function(i){t.$set(e,"originPort",i)},expression:"origin.originPort"}}):i("span",{staticClass:"form-text-alone"},[t._v(t._s(e.originPort))])],2):t._e()],1)}),t._v(" "),t.isEdit?i("b-form-fieldset",{attrs:{label:"변경이력<i class='require'>*</i>","invalid-feedback":t.$valid.msg.require,horizontal:!0}},[i("b-form-textarea",{attrs:{rows:6,required:""},model:{value:t.items.modifyHistReason,callback:function(e){t.$set(t.items,"modifyHistReason",e)},expression:"items.modifyHistReason"}})],1):t._e()],2)],1),t._v(" "),t.isEdit?t._e():i("div",{staticClass:"collapse-title"},[i("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.formHistory",modifiers:{formHistory:!0}}],staticClass:"btn-collapse"},[i("i",{staticClass:"fa"}),t._v("\n      처리이력\n    ")])],1),t._v(" "),t.isEdit?t._e():i("b-collapse",{attrs:{id:"formHistory",visible:""}},[i("b-form",{staticClass:"formView"},[i("div",{staticClass:"form-row"},[i("b-form-fieldset",{attrs:{label:"등록일시",horizontal:!0}},[i("b-form-input",{attrs:{value:t.items.createDateTime,plaintext:"",type:"text"}})],1),t._v(" "),i("b-form-fieldset",{attrs:{label:"등록자",horizontal:!0}},[i("b-form-input",{attrs:{value:t.items.createId,plaintext:"",type:"text"}})],1)],1),t._v(" "),i("div",{staticClass:"form-row"},[i("b-form-fieldset",{attrs:{label:"수정일시",horizontal:!0}},[i("b-form-input",{attrs:{value:t.items.modifyDateTime,plaintext:"",type:"text"}})],1),t._v(" "),i("b-form-fieldset",{attrs:{label:"수정자",horizontal:!0}},[i("b-form-input",{attrs:{value:t.items.modifyId,plaintext:"",type:"text"}})],1)],1),t._v(" "),null!==t.items.processId?i("b-form-fieldset",{attrs:{label:"배포상태",horizontal:!0}},[i("input",{staticClass:"form-control-plaintext",staticStyle:{width:"50px"},attrs:{type:"text",readonly:"readonly"},domProps:{value:t.items.processStateCodeName}}),t._v(" "),i("a",{staticClass:"btn btn-in-table",attrs:{href:"#/workflow/service/"+t.items.processId,target:"_blank"}},[t._v(t._s(t.items.processId))])]):t._e()],1)],1),t._v(" "),t.isEdit?i("div",{staticClass:"page-btn"},[i("b-button",{attrs:{type:"button",variant:"outline-secondary"},on:{click:t.onView}},[t._v("취소")]),t._v(" "),i("b-button",{attrs:{type:"button",variant:"primary"},on:{click:t.onSubmit}},[t._v("저장")])],1):i("div",{staticClass:"page-btn"},[i("b-button",{attrs:{type:"button",variant:"outline-secondary"},on:{click:t.showHistory}},[t._v("이력관리")]),t._v(" "),t.isProcessComplete?i("b-button",{attrs:{type:"button",variant:"primary"},on:{click:t.onEdit}},[t._v("수정")]):t._e()],1),t._v(" "),i("b-modal",{attrs:{size:"lg",title:"이력관리"},model:{value:t.isModalHistory,callback:function(e){t.isModalHistory=e},expression:"isModalHistory"}},[i("section",{staticClass:"board"},[i("b-table",{attrs:{hover:"","show-empty":"",items:t.history.items,fields:t.history.fields,"current-page":t.history.pageInfo.page,"per-page":t.history.pageInfo.size},scopedSlots:t._u([{key:"histMgmtId",fn:function(e){return[i("a",{attrs:{href:t.getHistoryLink(e.value),target:"_blank"}},[t._v("보기")])]}}])})],1),t._v(" "),i("b-pagination",{staticClass:"mt-2",attrs:{"total-rows":t.history.pageInfo.totalCount,"per-page":t.history.pageInfo.size},model:{value:t.history.pageInfo.page,callback:function(e){t.$set(t.history.pageInfo,"page",e)},expression:"history.pageInfo.page"}}),t._v(" "),i("div",{attrs:{slot:"modal-footer"},slot:"modal-footer"},[i("b-button",{attrs:{type:"button",variant:"primary"},on:{click:function(e){t.isModalHistory=!1}}},[t._v("확인")])],1)],1)],1)},o=[],a={render:s,staticRenderFns:o};e.a=a}});